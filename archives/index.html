<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<meta name="theme-color" content="#0A0A14">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>Holocron Archives ‚Äî OutpostX</title>
<link rel="manifest" href="manifest.json">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;900&family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{--bg:#0A0A14;--card:#0F0F1E;--gold:#FFD700;--orange:#FF6B35;--cyan:#00D4FF;--green:#39FF14;--dim:#667;--text:#E8E6E3;--r:14px}
html,body{height:100%;font-family:'Inter',sans-serif;background:var(--bg);color:var(--text);overflow-x:hidden;-webkit-tap-highlight-color:transparent}
a{color:var(--cyan);text-decoration:none}
a:hover{text-decoration:underline}
button{font-family:inherit;cursor:pointer;border:none;outline:none}

/* ‚îÄ‚îÄ TAB BAR ‚îÄ‚îÄ */
.tab-bar{position:fixed;bottom:0;left:0;right:0;z-index:100;background:#0d0d1a;border-top:1px solid #1a1a2e;display:flex;padding:4px 0 env(safe-area-inset-bottom,8px)}
.tab{flex:1;display:flex;flex-direction:column;align-items:center;gap:2px;padding:8px 0;background:none;color:var(--dim);font-size:10px;font-family:'Orbitron',sans-serif;letter-spacing:1px;transition:color .3s}
.tab.active{color:var(--gold)}
.tab .ico{font-size:22px}

/* ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ */
.header{position:sticky;top:0;z-index:90;background:linear-gradient(180deg,#0d0d1a 80%,transparent);padding:14px 16px 10px;text-align:center}
.header h1{font-family:'Orbitron',sans-serif;font-size:16px;color:var(--gold);letter-spacing:3px}
.header .sub{font-size:12px;color:var(--dim);margin-top:4px}

/* ‚îÄ‚îÄ SCREENS ‚îÄ‚îÄ */
.screen{display:none;padding:16px;padding-bottom:100px}
.screen.active{display:block}

/* ‚îÄ‚îÄ HUB ‚îÄ‚îÄ */
.hub-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-bottom:24px}
.hub-card{background:var(--card);border:1px solid #1e1e3a;border-radius:var(--r);padding:24px 16px;text-align:center;cursor:pointer;transition:border-color .3s,transform .2s}
.hub-card:active{transform:scale(.97)}
.hub-card:hover{border-color:var(--gold)}
.hub-card .hc-icon{font-size:36px;margin-bottom:8px}
.hub-card .hc-title{font-family:'Orbitron',sans-serif;font-size:11px;color:var(--gold);letter-spacing:1px;margin-bottom:6px}
.hub-card .hc-desc{font-size:12px;color:var(--dim);line-height:1.5}
.transmission-link{display:block;text-align:center;margin:20px 0;padding:16px;background:var(--card);border:1px solid rgba(255,215,0,.2);border-radius:var(--r);font-family:'Orbitron',sans-serif;font-size:12px;color:var(--gold);letter-spacing:2px;transition:border-color .3s}
.transmission-link:hover{border-color:var(--gold);text-decoration:none}
.family-badge{text-align:center;margin-top:24px;padding:16px;font-size:12px;color:var(--dim);line-height:1.8}
.family-badge .names{color:var(--gold);font-family:'Orbitron',sans-serif;font-size:11px;letter-spacing:1px}

/* ‚îÄ‚îÄ SHARED CONTENT STYLES ‚îÄ‚îÄ */
.section-title{font-family:'Orbitron',sans-serif;font-size:13px;color:var(--gold);letter-spacing:2px;margin:24px 0 12px;padding-bottom:8px;border-bottom:1px solid #1e1e3a}
.section-title:first-child{margin-top:0}

/* Day cards */
.day-card{background:var(--card);border:1px solid #1e1e3a;border-radius:var(--r);margin-bottom:16px;overflow:hidden}
.day-head{padding:14px 16px;cursor:pointer;display:flex;align-items:center;gap:12px}
.day-badge{background:var(--orange);color:#000;font-family:'Orbitron',sans-serif;font-size:11px;font-weight:900;padding:6px 12px;border-radius:8px;white-space:nowrap}
.day-info{flex:1;min-width:0}
.day-name{font-family:'Orbitron',sans-serif;font-size:12px;color:var(--gold);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.day-date{font-size:11px;color:var(--dim);margin-top:2px}
.day-chev{font-size:18px;color:var(--dim);transition:transform .3s;flex-shrink:0}
.day-card.open .day-chev{transform:rotate(180deg)}
.day-body{max-height:0;overflow:hidden;transition:max-height .4s ease}
.day-card.open .day-body{max-height:5000px}
.day-content{padding:0 16px 16px}

/* Timeline items */
.tl{list-style:none;padding:0}
.tl li{display:flex;gap:10px;padding:8px 0;border-bottom:1px solid #111128;font-size:13px;line-height:1.6}
.tl li:last-child{border:none}
.tl .time{font-family:'Orbitron',sans-serif;font-size:10px;color:var(--cyan);min-width:44px;padding-top:2px;flex-shrink:0}
.tag{display:inline-block;font-size:9px;font-family:'Orbitron',sans-serif;padding:2px 6px;border-radius:4px;margin-left:4px;vertical-align:middle}
.tag-m{background:rgba(255,107,53,.15);color:var(--orange)}
.tag-f{background:rgba(255,215,0,.1);color:var(--gold)}
.tag-p{background:rgba(0,212,255,.1);color:var(--cyan)}
.photo-ops{margin-top:12px;padding:10px 14px;background:#111128;border-radius:8px;font-size:12px;color:var(--dim)}
.photo-ops b{color:var(--cyan);font-size:10px;font-family:'Orbitron',sans-serif;letter-spacing:1px}
.photo-ops ul{list-style:none;padding:0;margin-top:6px;columns:2;column-gap:12px}
.photo-ops li::before{content:'üì∏ ';font-size:10px}
.photo-ops li{padding:2px 0}

/* Mission cards (static reference) */
.ms-card{background:var(--card);border:1px solid #1e1e3a;border-radius:var(--r);margin-bottom:14px;overflow:hidden}
.ms-head{display:flex;align-items:center;gap:12px;padding:14px 16px;cursor:pointer}
.ms-num{width:36px;height:36px;border-radius:50%;background:var(--orange);color:#000;font-family:'Orbitron',sans-serif;font-weight:900;font-size:14px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
.ms-info{flex:1;min-width:0}
.ms-title{font-family:'Orbitron',sans-serif;font-size:12px;color:var(--gold);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.ms-meta{font-size:11px;color:var(--dim);margin-top:2px}
.ms-chev{font-size:18px;color:var(--dim);transition:transform .3s;flex-shrink:0}
.ms-card.open .ms-chev{transform:rotate(180deg)}
.ms-body{max-height:0;overflow:hidden;transition:max-height .4s ease}
.ms-card.open .ms-body{max-height:3000px}
.ms-content{padding:0 16px 16px}
.ms-label{font-family:'Orbitron',sans-serif;font-size:10px;color:var(--cyan);letter-spacing:1px;margin:14px 0 6px}
.ms-label:first-child{margin-top:0}
.ms-narrative{background:#111128;border-left:4px solid var(--gold);border-radius:0 8px 8px 0;padding:12px;font-size:13px;line-height:1.6;color:#ddd;font-style:italic}
.ms-content p{font-size:13px;line-height:1.7;color:#bbb}
.ms-content ul{padding-left:16px;list-style:none}
.ms-content li{font-size:13px;line-height:1.7;color:#bbb;padding:2px 0}
.ms-content li::before{content:'‚ñ∏ ';color:var(--orange)}
.ms-reward{color:var(--gold);font-weight:700}
.ms-note{margin-top:10px;font-size:12px;color:#cc9900;padding:8px 12px;background:rgba(255,215,0,.04);border:1px solid rgba(255,215,0,.12);border-radius:6px}

/* Recipe cards */
.recipe-card{background:var(--card);border:1px solid #1e1e3a;border-radius:var(--r);margin-bottom:14px;overflow:hidden;position:relative}
.rc-head{padding:14px 16px;cursor:pointer;display:flex;align-items:center;justify-content:space-between}
.rc-title{font-family:'Orbitron',sans-serif;font-size:12px;color:var(--gold)}
.rc-when{font-size:11px;color:var(--dim)}
.rc-chev{font-size:18px;color:var(--dim);transition:transform .3s}
.recipe-card.open .rc-chev{transform:rotate(180deg)}
.rc-body{max-height:0;overflow:hidden;transition:max-height .4s ease}
.recipe-card.open .rc-body{max-height:3000px}
.rc-content{padding:0 16px 16px}
.rc-label{font-family:'Orbitron',sans-serif;font-size:10px;color:var(--orange);letter-spacing:1px;margin:12px 0 6px}
.rc-content ul,.rc-content ol{padding-left:18px;font-size:13px;color:#bbb;line-height:1.8}

/* Grocery */
.grocery-section{background:var(--card);border-radius:var(--r);padding:14px 16px;margin-bottom:10px}
.grocery-section h4{font-family:'Orbitron',sans-serif;font-size:11px;color:var(--gold);margin-bottom:8px}
.grocery-section ul{list-style:none;padding:0;columns:2;column-gap:16px}
.grocery-section li{font-size:12px;color:#bbb;padding:3px 0}
.grocery-section li::before{color:var(--dim)}

/* Clothing */
.cloth-card{background:var(--card);border:1px solid #1e1e3a;border-radius:var(--r);margin-bottom:14px;overflow:hidden}
.cl-head{padding:14px 16px;cursor:pointer;display:flex;align-items:center;justify-content:space-between}
.cl-title{font-family:'Orbitron',sans-serif;font-size:12px;color:var(--gold)}
.cl-weather{font-size:11px;color:var(--dim)}
.cl-chev{font-size:18px;color:var(--dim);transition:transform .3s}
.cloth-card.open .cl-chev{transform:rotate(180deg)}
.cl-body{max-height:0;overflow:hidden;transition:max-height .4s ease}
.cloth-card.open .cl-body{max-height:3000px}
.cl-content{padding:0 16px 16px}
.person-block{margin-bottom:14px}
.person-name{font-family:'Orbitron',sans-serif;font-size:10px;color:var(--orange);letter-spacing:1px;margin-bottom:6px}
.person-block p{font-size:13px;color:#bbb;line-height:1.7;margin-bottom:4px}

/* Packing checklist */
.pack-grid{columns:2;column-gap:16px}
.pack-grid label{display:flex;align-items:center;gap:8px;font-size:13px;padding:6px 0;color:#bbb;cursor:pointer}
.pack-grid input[type=checkbox]{width:18px;height:18px;flex-shrink:0;appearance:none;-webkit-appearance:none;border:2px solid #555;border-radius:4px;background:transparent;cursor:pointer;position:relative}
.pack-grid input[type=checkbox]:checked{background:var(--green);border-color:var(--green)}
.pack-grid input[type=checkbox]:checked::after{content:'‚úì';position:absolute;top:-1px;left:2px;font-size:13px;color:#000;font-weight:bold}
.pack-grid label:has(input:checked){color:var(--dim);text-decoration:line-through}

/* Meal swap */
.swap-toggle{position:absolute;top:10px;right:12px;padding:5px 14px;border-radius:8px;font-size:11px;font-family:'Orbitron',sans-serif;letter-spacing:1px;background:var(--card);color:var(--orange);border:1px solid var(--orange);cursor:pointer;transition:all .3s;z-index:2}
.swap-toggle:hover{background:var(--orange);color:#000}

/* Grocery checkboxes */
.grocery-section ul{list-style:none;padding:0}
.grocery-section li{padding:0}
.grocery-check{display:flex;align-items:center;gap:8px;font-size:13px;padding:5px 0;color:#bbb;cursor:pointer}
.grocery-check input[type=checkbox]{width:18px;height:18px;accent-color:var(--green);flex-shrink:0;appearance:none;-webkit-appearance:none;border:2px solid #555;border-radius:4px;background:transparent;cursor:pointer;position:relative}
.grocery-check input[type=checkbox]:checked{background:var(--green);border-color:var(--green)}
.grocery-check input[type=checkbox]:checked::after{content:'‚úì';position:absolute;top:-1px;left:2px;font-size:13px;color:#000;font-weight:bold}
.grocery-check.checked{color:var(--dim);text-decoration:line-through}

/* Prep kit */
.prep-box{background:var(--card);border:1px solid #1e1e3a;border-radius:var(--r);padding:14px 16px;margin-bottom:14px}
.prep-box h4{font-family:'Orbitron',sans-serif;font-size:11px;color:var(--gold);margin-bottom:10px}
.prep-box.code{border-color:rgba(255,215,0,.15);background:rgba(255,215,0,.03)}
.prep-box .code-text{text-align:center;color:var(--gold);font-style:italic;font-size:16px;line-height:2.2}

/* Quick links */
.ext-link{display:inline-block;padding:6px 12px;background:var(--card);border:1px solid #1e1e3a;border-radius:8px;font-size:12px;margin:4px;transition:border-color .3s}
.ext-link:hover{border-color:var(--cyan);text-decoration:none}

.mission-artifact{display:inline-block;margin:6px 4px 0;padding:6px 14px;background:rgba(232,160,40,0.1);border:1px solid rgba(232,160,40,0.3);border-radius:8px;font-size:11px;font-family:'Orbitron',sans-serif;letter-spacing:1px;color:var(--orange);text-decoration:none;transition:all .3s}
.mission-artifact:hover{background:var(--orange);color:#000}

@media(max-width:400px){
  .hub-grid{grid-template-columns:1fr}
  .grocery-section ul{columns:1}
  .pack-grid{columns:1}
  .photo-ops ul{columns:1}
}

/* ‚îÄ‚îÄ COUNTDOWN ‚îÄ‚îÄ */
.countdown{background:var(--card);border:1px solid rgba(255,215,0,.2);border-radius:var(--r);padding:20px 16px;margin-bottom:20px;text-align:center}
.countdown .cd-label{font-family:'Orbitron',sans-serif;font-size:10px;color:var(--dim);letter-spacing:2px;margin-bottom:10px}
.countdown .cd-grid{display:flex;justify-content:center;gap:12px}
.countdown .cd-unit{display:flex;flex-direction:column;align-items:center;min-width:56px}
.countdown .cd-num{font-family:'Orbitron',sans-serif;font-size:28px;font-weight:900;color:var(--gold);line-height:1}
.countdown .cd-lbl{font-family:'Orbitron',sans-serif;font-size:8px;color:var(--dim);letter-spacing:1px;margin-top:4px}
.countdown .cd-status{font-family:'Orbitron',sans-serif;font-size:14px;color:var(--gold);letter-spacing:2px}

/* ‚îÄ‚îÄ HEADER ACTIONS ‚îÄ‚îÄ */
.header-actions{display:flex;gap:6px;position:absolute;right:12px;top:12px}
.icon-btn{width:32px;height:32px;border-radius:50%;background:var(--card);border:1px solid #1e1e3a;font-size:16px;display:flex;align-items:center;justify-content:center;color:var(--dim);transition:border-color .3s,color .3s}
.icon-btn:hover{border-color:var(--gold);color:var(--gold)}

/* ‚îÄ‚îÄ LIGHT MODE ‚îÄ‚îÄ */
html.light{--bg:#F5F0E8;--card:#FFFFFF;--gold:#B8860B;--orange:#D4621B;--cyan:#0088AA;--green:#228B22;--dim:#888;--text:#2C2418}
html.light .tab-bar{background:#F0EBE3;border-top-color:#D5CFC7}
html.light .header{background:linear-gradient(180deg,#F0EBE3 80%,transparent)}
html.light .day-badge{background:var(--orange);color:#fff}
html.light .ms-num{background:var(--orange);color:#fff}
html.light .ms-narrative{background:#F8F5F0;border-left-color:var(--gold)}
html.light .icon-btn{background:var(--card);border-color:#D5CFC7}
html.light .photo-ops{background:#F0EDE6}
html.light .countdown{border-color:rgba(184,134,11,.3)}
html.light .tl li{border-bottom-color:#E8E2DA}
html.light .hub-card{border-color:#D5CFC7}
html.light .ms-card,html.light .recipe-card,html.light .cloth-card,html.light .day-card{border-color:#D5CFC7}
html.light .prep-box{border-color:#D5CFC7}
html.light .grocery-section{background:#fff}
html.light .add-item-input{border-color:#D5CFC7;color:var(--text)}
html.light .add-item-input:focus{border-color:var(--gold)}
html.light .gallery-thumb{border-color:#D5CFC7}

/* ‚îÄ‚îÄ EDITABLE LISTS ‚îÄ‚îÄ */
.add-item-row{display:flex;gap:8px;margin-top:10px}
.add-item-input{flex:1;background:transparent;border:1px solid #1e1e3a;border-radius:8px;padding:8px 12px;font-size:13px;color:var(--text);font-family:inherit;outline:none;transition:border-color .3s}
.add-item-input:focus{border-color:var(--gold)}
.add-item-input::placeholder{color:var(--dim)}
.add-btn{background:var(--gold);color:#000;font-family:'Orbitron',sans-serif;font-size:10px;font-weight:700;padding:8px 14px;border-radius:8px;letter-spacing:1px;white-space:nowrap;transition:opacity .3s}
.add-btn:hover{opacity:.85}
.del-btn{background:none;color:#633;font-size:16px;padding:0 6px;margin-left:auto;flex-shrink:0;opacity:.5;transition:opacity .3s,color .3s}
.del-btn:hover{opacity:1;color:#f44}

/* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
.toast{position:fixed;bottom:80px;left:50%;transform:translateX(-50%) translateY(20px);background:var(--gold);color:#000;font-family:'Orbitron',sans-serif;font-size:11px;letter-spacing:1px;padding:10px 20px;border-radius:10px;opacity:0;transition:opacity .3s,transform .3s;z-index:200;pointer-events:none}
.toast.show{opacity:1;transform:translateX(-50%) translateY(0)}

/* ‚îÄ‚îÄ EXPORT BTNS ‚îÄ‚îÄ */
.export-btn{display:inline-flex;align-items:center;gap:6px;padding:6px 14px;background:var(--card);border:1px solid #1e1e3a;border-radius:8px;font-size:11px;font-family:'Orbitron',sans-serif;color:var(--cyan);letter-spacing:1px;cursor:pointer;transition:border-color .3s}
.export-btn:hover{border-color:var(--cyan)}

/* ‚îÄ‚îÄ PHOTO GALLERY ‚îÄ‚îÄ */
.gallery-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:8px;margin-bottom:16px}
.gallery-thumb{position:relative;aspect-ratio:1;border-radius:10px;overflow:hidden;cursor:pointer;border:1px solid #1e1e3a}
.gallery-thumb img{width:100%;height:100%;object-fit:cover}
.gallery-thumb .gt-del{position:absolute;top:4px;right:4px;width:24px;height:24px;border-radius:50%;background:rgba(0,0,0,.7);color:#f44;font-size:14px;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .3s}
.gallery-thumb:hover .gt-del,.gallery-thumb:active .gt-del{opacity:1}
.gallery-thumb .gt-cap{position:absolute;bottom:0;left:0;right:0;background:linear-gradient(transparent,rgba(0,0,0,.8));padding:4px 6px;font-size:10px;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.add-photo-btn{display:flex;align-items:center;justify-content:center;gap:8px;width:100%;padding:14px;background:var(--card);border:2px dashed #1e1e3a;border-radius:var(--r);font-family:'Orbitron',sans-serif;font-size:12px;color:var(--dim);letter-spacing:1px;cursor:pointer;transition:border-color .3s,color .3s}
.add-photo-btn:hover{border-color:var(--gold);color:var(--gold)}
.gallery-empty{text-align:center;padding:60px 20px;color:var(--dim)}
.gallery-empty .ge-icon{font-size:48px;margin-bottom:12px}
.gallery-empty p{font-size:13px;line-height:1.6}

/* ‚îÄ‚îÄ LIGHTBOX ‚îÄ‚îÄ */
.lightbox{position:fixed;inset:0;background:rgba(0,0,0,.95);z-index:300;display:none;flex-direction:column;align-items:center;justify-content:center;padding:20px}
.lightbox.active{display:flex}
.lightbox img{max-width:100%;max-height:70vh;border-radius:10px;object-fit:contain}
.lightbox .lb-cap{margin-top:12px;font-family:'Orbitron',sans-serif;font-size:12px;color:var(--gold);letter-spacing:1px;text-align:center;cursor:pointer;min-height:20px;padding:4px 12px}
.lightbox .lb-close{position:absolute;top:16px;right:16px;width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,.1);color:#fff;font-size:24px;display:flex;align-items:center;justify-content:center;cursor:pointer}
.lightbox .lb-nav{position:absolute;top:50%;width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,.1);color:#fff;font-size:20px;display:flex;align-items:center;justify-content:center;cursor:pointer;transform:translateY(-50%)}
.lightbox .lb-prev{left:12px}
.lightbox .lb-next{right:12px}
</style>
</head>
<body>

<!-- HEADER -->
<div class="header">
  <h1>üìú HOLOCRON ARCHIVES</h1>
  <div class="sub">OPERATION OUTPOST X ‚Äî FULL MISSION BRIEFING</div>
  <div class="header-actions">
    <button class="icon-btn" onclick="shareApp()" title="Share">üì§</button>
    <button class="icon-btn" id="themeBtn" onclick="toggleTheme()" title="Toggle theme">‚òÄÔ∏è</button>
  </div>
</div>

<!-- SCREENS -->
<div id="hubScreen" class="screen active"></div>
<div id="itineraryScreen" class="screen"></div>
<div id="missionsScreen" class="screen"></div>
<div id="mealsScreen" class="screen"></div>
<div id="wardrobeScreen" class="screen"></div>
<div id="galleryScreen" class="screen"></div>

<!-- LIGHTBOX -->
<div class="lightbox" id="lightbox" onclick="closeLightbox(event)">
  <div class="lb-close" onclick="closeLightbox()">‚úï</div>
  <button class="lb-nav lb-prev" onclick="event.stopPropagation();navLightbox(-1)">‚Äπ</button>
  <button class="lb-nav lb-next" onclick="event.stopPropagation();navLightbox(1)">‚Ä∫</button>
  <img id="lbImg" src="">
  <div class="lb-cap" id="lbCap" onclick="event.stopPropagation();editCaption(lbIndex)"></div>
</div>
<div class="toast" id="toast"></div>
<input type="file" id="photoInput" accept="image/*" multiple hidden onchange="handlePhotos(this.files)">

<!-- TAB BAR -->
<div class="tab-bar">
  <button class="tab active" onclick="showTab('hub')"><span class="ico">üè†</span>HOME</button>
  <button class="tab" onclick="showTab('itinerary')"><span class="ico">üìã</span>ITINERARY</button>
  <button class="tab" onclick="showTab('missions')"><span class="ico">‚öîÔ∏è</span>MISSIONS</button>
  <button class="tab" onclick="showTab('meals')"><span class="ico">üçΩÔ∏è</span>PROVISIONS</button>
  <button class="tab" onclick="showTab('wardrobe')"><span class="ico">üëï</span>WARDROBE</button>
  <button class="tab" onclick="showTab('gallery')"><span class="ico">üì∏</span>MEMORIES</button>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   DATA
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const DAYS = [
  { num:"Day 1", name:"ARRIVAL ON THE OUTER RIM", date:"Wednesday, April 8", items:[
    {t:"AM",e:"Fly Seattle ‚Üí Las Vegas (early flight)"},
    {t:"11:00",e:"Pick up rental car + grocery stop in Las Vegas or St. George"},
    {t:"12:00",e:"Drive to OutpostX (~2.5 hrs)"},
    {t:"2:30",e:"Arrive at OutpostX, check into Glass Cave Villa"},
    {t:"3:30",e:"Costume up! Everyone changes into Star Wars gear"},
    {t:"4:00",e:'Sand Cruiser orientation ride <span class="tag tag-p">PHOTO</span>'},
    {t:"5:30",e:'Dinner: "Mos Eisley Cantina Wraps" <span class="tag tag-f">MEAL</span>'},
    {t:"6:30",e:'Mission 1: "Awakening the Force" at fire pit <span class="tag tag-m">MISSION</span>'},
    {t:"7:30",e:'Stargazing from the deck ‚Äî "Blue Milk" drinks <span class="tag tag-p">PHOTO</span>'}
  ], photos:["Arrival silhouette","Glass Cave interior","Sand Cruiser shot","Fire pit portrait","Stargazing"]},

  { num:"Day 2", name:"THE TRAINING BEGINS", date:"Thursday, April 9", items:[
    {t:"7:30",e:'Sunrise + coffee. Breakfast: "Jedi Fuel" <span class="tag tag-f">MEAL</span>'},
    {t:"9:00",e:'Mission 2: "The Way of the Lightsaber" <span class="tag tag-m">MISSION</span>'},
    {t:"10:00",e:'Mission 3: "The Sand Cruiser Patrol" <span class="tag tag-m">MISSION</span>'},
    {t:"11:00",e:'Mission 4: "The Force Balance" ‚Äî trampoline <span class="tag tag-m">MISSION</span>'},
    {t:"12:00",e:'Lunch: "Tatooine Trader\'s Pitas" <span class="tag tag-f">MEAL</span>'},
    {t:"1:00",e:"Rest, free play, explore"},
    {t:"2:00",e:'Mission 5: "Crafting a Jedi Artifact" ‚Äî pottery <span class="tag tag-m">MISSION</span>'},
    {t:"3:30",e:'Cantina mocktails <span class="tag tag-p">PHOTO</span>'},
    {t:"4:00",e:'Spa: "Healing Springs" ‚Äî hot tub, sauna, clay bath'},
    {t:"5:30",e:'Dinner: "Campfire Feast" ‚Äî kebabs + s\'mores <span class="tag tag-f">MEAL</span>'},
    {t:"7:30",e:'Movie night at Kaan Lounge ‚Äî Star Wars: A New Hope <span class="tag tag-p">PHOTO</span>'}
  ], photos:["Father-son lightsaber training","Sand Cruiser action","Pottery candid","Cantina toast","Campfire family","Movie night"]},

  { num:"Day 3", name:"THE QUEST BEYOND THE OUTPOST", date:"Friday, April 10", items:[
    {t:"7:30",e:'Breakfast: "Rebel Morning Rations" (overnight oats) <span class="tag tag-f">MEAL</span>'},
    {t:"8:30",e:"Pack picnic, drive to Snow Canyon State Park (~45 min)"},
    {t:"9:30",e:'Mission 6: "Tracking the Kyber Crystal" ‚Äî Petrified Dunes + Lava Flow Trail <span class="tag tag-m">MISSION</span>'},
    {t:"11:30",e:'Picnic: "Rebel Rations Pack" <span class="tag tag-f">MEAL</span>'},
    {t:"12:30",e:"Drive back to OutpostX"},
    {t:"1:30",e:"Rest / nap for Syba Taan"},
    {t:"3:00",e:'Mission 7: "The Final Trials" <span class="tag tag-m">MISSION</span>'},
    {t:"4:30",e:"Spa / free time"},
    {t:"5:30",e:"Costume up for the ceremony"},
    {t:"6:00",e:'Dinner: "Jedi Council Feast" ‚Äî steak + sparkling cider <span class="tag tag-f">MEAL</span>'},
    {t:"7:30",e:'Mission 8: "The Knighting Ceremony" ‚Äî under the stars <span class="tag tag-m">MISSION</span> <span class="tag tag-p">PHOTO</span>'},
    {t:"8:30",e:"Celebration toast, stargazing"}
  ], photos:["Canyon hike panorama","Kyber crystal discovery","Final Trials","Pre-ceremony portrait","THE KNIGHTING","Family under stars"]},

  { num:"Day 4", name:"RETURN TO THE CORE WORLDS", date:"Saturday, April 11", items:[
    {t:"7:00",e:"Sunrise meditation (optional)"},
    {t:"7:30",e:'Brunch: "Galactic Send-off" ‚Äî pancakes + bacon <span class="tag tag-f">MEAL</span>'},
    {t:"9:00",e:'Final Sand Cruiser ride, last costume photos <span class="tag tag-p">PHOTO</span>'},
    {t:"10:00",e:"Pack up, check out"},
    {t:"10:30",e:"Drive to Las Vegas (~2.5 hrs)"},
    {t:"1:00",e:"Arrive Las Vegas, return rental"},
    {t:"PM",e:"Fly home to Seattle"}
  ], photos:["Sunrise silhouette","Final costume portrait","Departure 'walking away' shot"]}
];

const MISSIONS = [
  { id:1, title:"AWAKENING THE FORCE", meta:"Day 1 ¬∑ Evening ¬∑ 15 min ¬∑ Fire Pit",
    dialogue:"The Force is all around us, Syba Taan. It flows through every rock, every flame, every gust of wind. A Jedi does not see the Force ‚Äî a Jedi feels it. Close your eyes. Tell me what the Force is showing you.",
    activity:"Blindfold Sybastian with a bandana near the fire pit. He must sit still, breathe, and identify 5 sounds: wind, fire crackling, footsteps (Matthew walks around), Megan clapping, rocks tapping. Master explains how Jedi use the Force to sense what they cannot see.",
    props:["Bandana (blindfold)","Small rocks to tap together"], reward:"Force Awareness" },
  { id:2, title:"THE WAY OF THE LIGHTSABER", meta:"Day 2 ¬∑ 9:00 AM ¬∑ 25 min ¬∑ Open area",
    dialogue:"A lightsaber is not just a weapon, Youngling. It is an extension of you ‚Äî of your will, your focus, your courage. Today, I will teach you the three sacred forms. Watch closely.",
    activity:"Teach 3 lightsaber forms: The Shield (horizontal defense), The Strike (overhead swing), The Sweep (side-to-side at knee height). Practice 5√ó slow, 3√ó fast. End with slow-motion duel.",
    props:["Both lightsabers","Pool noodle targets (optional)"], reward:"Form I: Shii-Cho" },
  { id:3, title:"THE SAND CRUISER PATROL", meta:"Day 2 ¬∑ 10:00 AM ¬∑ 30 min ¬∑ OutpostX property",
    dialogue:"The Council has received reports of unusual activity on the far side of this outpost. We must patrol the perimeter. Stay sharp, Padawan ‚Äî report anything unusual you see.",
    activity:"During Sand Cruiser ride, Sybastian is the 'Scout.' Spot and call out 5 interesting things. Matthew confirms each and adds Jedi lore.",
    props:["Sand Cruiser (OutpostX amenity)","Small notepad for mission log"], reward:"Outer Rim Scout" },
  { id:4, title:"THE FORCE BALANCE", meta:"Day 2 ¬∑ 11:00 AM ¬∑ 20 min ¬∑ Trampoline area",
    dialogue:"A Jedi must command their body as well as their mind. Balance. Control. Grace. The Force flows through a body that is centered. Show me your balance, Youngling.",
    activity:"Jedi Simon Says on trampolines: Force Jump (high jump arms up), Jedi Freeze (hold still 5 sec), Spin Attack (gentle spin jump), Grogu Bounce (tiny fast bounces with fist ears). End with synchronized Force Jump.",
    props:["In-ground trampolines (OutpostX amenity)"], reward:"Force Balance" },
  { id:5, title:"CRAFTING A JEDI ARTIFACT", meta:"Day 2 ¬∑ 2:00 PM ¬∑ 45 min ¬∑ Pottery studio",
    dialogue:"Every Jedi creates something with their own hands ‚Äî a relic imbued with the Force. It becomes part of you. Today, you will craft your artifact from the clay of this desert world. Focus your energy into it.",
    activity:"OutpostX pottery wheels ‚Äî create a small bowl, cup, or Kyber crystal holder. Both Matthew and Sybastian make one.",
    props:["Pottery wheels (OutpostX amenity ‚Äî included)"], reward:"Jedi Artisan" },
  { id:6, title:"TRACKING THE KYBER CRYSTAL", meta:"Day 3 ¬∑ 9:30 AM ¬∑ 90 min ¬∑ Snow Canyon State Park",
    dialogue:"Deep in the canyons of this world, the Force has hidden a Kyber Crystal ‚Äî the heart of every lightsaber. The crystal calls to those who are worthy. Listen, Padawan. Follow the signs. The crystal will reveal itself to you.",
    activity:'Hike Petrified Sand Dunes (1.2 mi) + Lava Flow Trail (1.7 mi). Megan pre-hides crystal. 3 clues: (1) Past where ancient dunes turned to stone, (2) Where fire once flowed from the earth, (3) It hides where a Jedi would stop to rest. When found: "The crystal chose you, Syba Taan."',
    props:["Crystal or geode (wrapped in cloth)","3 clue cards","Water + sunscreen + snacks"],
    reward:"Crystal Guardian",
    note:"‚ö†Ô∏è Jenny's Canyon is closed March 15‚ÄìJune 1. Petrified Dunes and Lava Flow Trail are open year-round!" },
  { id:7, title:"THE FINAL TRIALS", meta:"Day 3 ¬∑ 3:00 PM ¬∑ 30 min ¬∑ OutpostX grounds",
    dialogue:"You have trained well, Youngling. But before you can be knighted, you must pass the three Final Trials. These will test your body, your mind, and your heart. Are you ready?",
    activity:"Trial of Balance: Walk a line heel-to-toe 10 steps. Trial of Focus: Stack 5 rocks into a cairn in silence. Trial of Courage: Recite the Jedi Code ‚Äî 'I am calm. I am kind. I am brave. I am one with the Force.'",
    props:["Rope or stick (balance line)","Flat rocks"], reward:"Trials Complete" },
  { id:8, title:"THE KNIGHTING CEREMONY", meta:"Day 3 ¬∑ 7:30 PM ¬∑ 15 min ¬∑ Under the stars",
    dialogue:"Syba Taan. You came to this outpost a Youngling. You have trained in the ways of the Force. You have wielded a lightsaber. You have tracked a Kyber Crystal across the desert. You have passed the Final Trials. You are ready.",
    activity:'(1) Sybastian kneels, (2) Matthew ignites lightsaber overhead, (3) Touches each shoulder, (4) "By the will of the Force and the authority of the Jedi Council, I knight thee Jedi Knight Syba Taan. Rise, young Jedi." (5) Bow. (6) Present Kyber Crystal: "This crystal chose you in the desert, Syba Taan. It is yours ‚Äî the heart of your lightsaber." (7) Family hug + sparkling cider toast.',
    props:["Lightsabers (lit)","Kyber Crystal","Certificate","All 7 beads","Sparkling cider + cups"],
    reward:"üåü JEDI KNIGHT SYBA TAAN" }
];

const MEAL_SLOTS = [
  { id:'d1d', label:'Day 1 ‚Äî Dinner', options:[
    { title:"üåØ Mos Eisley Cantina Wraps", sections:[
      {label:"INGREDIENTS",items:["1 lb chicken breast, sliced thin","6 large flour tortillas","1 container hummus","Mixed greens","1 bell pepper, sliced","1 cucumber, sliced","Shredded cheese","Olive oil / cumin / paprika / garlic powder / salt / pepper"]},
      {label:"DIRECTIONS",items:["Season chicken with cumin, paprika, garlic powder, salt & pepper","Cook in skillet with olive oil, 6‚Äì7 min per side","Slice into strips","Spread hummus on tortillas","Layer greens, pepper, cucumber, chicken, cheese","Roll up tightly and halve"],ordered:true},
      {label:"ü•õ BLUE MILK",items:["2 cups milk + 1 tbsp vanilla + 2 tbsp honey + 3 drops blue food coloring","Blend with ice and serve cold"]},
      {label:"üë∂ FOR SYBASTIAN",items:["Fruit cup (grapes, berries, banana)"]}],
      grocery:[{c:"üçó Protein",i:"Chicken breast ‚Äî 1 lb"},{c:"ü•¶ Produce",i:"Mixed greens"},{c:"ü•¶ Produce",i:"1 bell pepper"},{c:"ü•¶ Produce",i:"1 cucumber"},{c:"ü•¶ Produce",i:"Grapes ‚Äî small bag"},{c:"ü•¶ Produce",i:"Berries (strawberries + blueberries)"},{c:"ü•¶ Produce",i:"Bananas"},{c:"üßÄ Dairy",i:"Shredded cheese"},{c:"üçû Bread",i:"Flour tortillas ‚Äî 6-pack"},{c:"üçØ Pantry",i:"Hummus"},{c:"üßÇ Spices",i:"Cumin"},{c:"üßÇ Spices",i:"Paprika"},{c:"üßÇ Spices",i:"Garlic powder"},{c:"üßÇ Spices",i:"Blue food coloring"}]
    },
    { title:"üçî Bantha Burgers", sections:[
      {label:"INGREDIENTS",items:["1.5 lb ground beef","6 hamburger buns","Lettuce, tomato, onion slices","Sliced cheese","Ketchup, mustard","Pickles (optional)"]},
      {label:"DIRECTIONS",items:["Form beef into 4‚Äì6 patties, season with salt & pepper","Grill 4‚Äì5 min per side","Toast buns on grill last minute","Assemble with toppings"],ordered:true},
      {label:"ü•õ BLUE MILK",items:["2 cups milk + 1 tbsp vanilla + 2 tbsp honey + 3 drops blue food coloring","Blend with ice and serve cold"]},
      {label:"üë∂ FOR SYBASTIAN",items:["Fruit cup (grapes, berries, banana)"]}],
      grocery:[{c:"üçó Protein",i:"Ground beef ‚Äî 1.5 lb"},{c:"ü•¶ Produce",i:"Lettuce"},{c:"ü•¶ Produce",i:"Tomato"},{c:"ü•¶ Produce",i:"Onion"},{c:"ü•¶ Produce",i:"Grapes ‚Äî small bag"},{c:"ü•¶ Produce",i:"Berries (strawberries + blueberries)"},{c:"ü•¶ Produce",i:"Bananas"},{c:"üßÄ Dairy",i:"Sliced cheese"},{c:"üçû Bread",i:"Hamburger buns ‚Äî 6-pack"},{c:"üçØ Pantry",i:"Ketchup"},{c:"üçØ Pantry",i:"Mustard"},{c:"üßÇ Spices",i:"Blue food coloring"}]
    }
  ]},
  { id:'d2b', label:'Day 2 ‚Äî Breakfast', options:[
    { title:"‚òï Jedi Fuel", sections:[
      {label:"INGREDIENTS",items:["6 eggs","Shredded cheese","English muffins or toast + butter","Fruit for Sybastian","Coffee"]},
      {label:"DIRECTIONS",items:["Scramble eggs with cheese","Toast muffins and butter","Slice fruit","Brew coffee"],ordered:true}],
      grocery:[{c:"üçó Protein",i:"Eggs ‚Äî 1 dozen"},{c:"üßÄ Dairy",i:"Shredded cheese"},{c:"üßÄ Dairy",i:"Butter ‚Äî 1 stick"},{c:"üçû Bread",i:"English muffins or bread"},{c:"ü•§ Beverages",i:"Coffee"}]
    }
  ]},
  { id:'d2l', label:'Day 2 ‚Äî Lunch', options:[
    { title:"ü•ô Tatooine Trader's Pitas", sections:[
      {label:"INGREDIENTS",items:["6 pita breads","Sliced turkey","Sliced cheese","Lettuce","Hummus"]},
      {label:"DIRECTIONS",items:["Spread hummus inside pita","Stuff with turkey, cheese, lettuce","Serve with pita chips"],ordered:true}],
      grocery:[{c:"üçó Protein",i:"Turkey deli meat ‚Äî 8 oz"},{c:"üßÄ Dairy",i:"Sliced cheese"},{c:"ü•¶ Produce",i:"Lettuce"},{c:"üçû Bread",i:"Pita breads ‚Äî 6-pack"},{c:"üçØ Pantry",i:"Hummus"},{c:"üçØ Pantry",i:"Pita chips"}]
    },
    { title:"üåÆ Wookiee Quesadillas", sections:[
      {label:"INGREDIENTS",items:["6 flour tortillas","Shredded chicken (leftover or rotisserie)","Shredded cheese","Salsa","Sour cream"]},
      {label:"DIRECTIONS",items:["Layer cheese and chicken on half of tortilla","Fold and cook in skillet 3 min per side","Slice into wedges","Serve with salsa and sour cream"],ordered:true}],
      grocery:[{c:"üçó Protein",i:"Rotisserie chicken"},{c:"üßÄ Dairy",i:"Shredded cheese"},{c:"üßÄ Dairy",i:"Sour cream"},{c:"üçû Bread",i:"Flour tortillas ‚Äî 6-pack"},{c:"üçØ Pantry",i:"Salsa"}]
    }
  ]},
  { id:'d2d', label:'Day 2 ‚Äî Dinner', options:[
    { title:"üî• Campfire Feast", sections:[
      {label:"KEBABS",items:["1.5 lbs chicken breast, cubed","2 bell peppers, chunked","2 zucchini, thick sliced","1 red onion, chunked","Wooden skewers (soak 30 min)","Marinade: olive oil / lemon / garlic / oregano / salt / pepper"]},
      {label:"FOIL POTATOES",items:["4 potatoes, diced","Olive oil, salt, pepper, garlic powder, paprika"]},
      {label:"DIRECTIONS",items:["Marinate chicken 30 min","Toss potatoes with spices, wrap in foil","Place foil on coals 20‚Äì25 min, flip halfway","Thread chicken + veggies on skewers","Grill 10‚Äì12 min, turning occasionally"],ordered:true},
      {label:"üç´ S'MORES",items:["Graham crackers + marshmallows + chocolate bars"]},
      {label:"ü•§ DRINK",items:["'Jogan Fruit Punch' ‚Äî mixed berry juice in camp cups"]}],
      grocery:[{c:"üçó Protein",i:"Chicken breast ‚Äî 1.5 lb"},{c:"ü•¶ Produce",i:"2 bell peppers"},{c:"ü•¶ Produce",i:"2 zucchini"},{c:"ü•¶ Produce",i:"1 red onion"},{c:"ü•¶ Produce",i:"4 potatoes"},{c:"ü•¶ Produce",i:"2 lemons"},{c:"ü•¶ Produce",i:"1 garlic head"},{c:"üçØ Pantry",i:"Wooden skewers"},{c:"üçØ Pantry",i:"Heavy-duty foil"},{c:"üçØ Pantry",i:"Marshmallows"},{c:"üçØ Pantry",i:"Chocolate bars √ó 4"},{c:"üçû Bread",i:"Graham crackers"},{c:"üßÇ Spices",i:"Olive oil"},{c:"üßÇ Spices",i:"Oregano"},{c:"üßÇ Spices",i:"Garlic powder"},{c:"üßÇ Spices",i:"Paprika"},{c:"ü•§ Beverages",i:"Mixed berry juice"}]
    },
    { title:"üç≤ Endor Campfire Chili", sections:[
      {label:"INGREDIENTS",items:["1.5 lb ground beef","1 onion, diced","2 bell peppers, diced","2 cans kidney beans, drained","2 cans diced tomatoes","2 tbsp tomato paste","Shredded cheese (topping)"]},
      {label:"DIRECTIONS",items:["Brown beef with onion and peppers in large pot","Add beans, tomatoes, tomato paste, and spices","Simmer 25‚Äì30 min, stirring occasionally","Serve topped with cheese"],ordered:true},
      {label:"üç´ S'MORES",items:["Graham crackers + marshmallows + chocolate bars"]},
      {label:"ü•§ DRINK",items:["'Jogan Fruit Punch' ‚Äî mixed berry juice in camp cups"]}],
      grocery:[{c:"üçó Protein",i:"Ground beef ‚Äî 1.5 lb"},{c:"ü•¶ Produce",i:"1 onion"},{c:"ü•¶ Produce",i:"2 bell peppers"},{c:"üçØ Pantry",i:"Canned kidney beans √ó 2"},{c:"üçØ Pantry",i:"Canned diced tomatoes √ó 2"},{c:"üçØ Pantry",i:"Tomato paste"},{c:"üçØ Pantry",i:"Marshmallows"},{c:"üçØ Pantry",i:"Chocolate bars √ó 4"},{c:"üçû Bread",i:"Graham crackers"},{c:"üßÄ Dairy",i:"Shredded cheese"},{c:"üßÇ Spices",i:"Chili powder"},{c:"üßÇ Spices",i:"Cumin"},{c:"üßÇ Spices",i:"Paprika"},{c:"ü•§ Beverages",i:"Mixed berry juice"}]
    }
  ]},
  { id:'d3b', label:'Day 3 ‚Äî Breakfast', options:[
    { title:"ü•£ Rebel Morning Rations", sections:[
      {label:"OVERNIGHT OATS",items:["2 cups rolled oats","2 cups milk","2 tbsp chia seeds","2 tbsp honey","1 tsp vanilla","Toppings: berries + banana"]},
      {label:"DIRECTIONS",items:["Mix oats, milk, chia, honey, vanilla in jars night before","Refrigerate overnight","Top with berries + banana in the morning"],ordered:true}],
      grocery:[{c:"üçØ Pantry",i:"Rolled oats"},{c:"üçØ Pantry",i:"Chia seeds"},{c:"üßÄ Dairy",i:"Milk ‚Äî half gallon"},{c:"üßÇ Spices",i:"Honey"},{c:"üßÇ Spices",i:"Vanilla extract"},{c:"ü•¶ Produce",i:"Berries (strawberries + blueberries)"},{c:"ü•¶ Produce",i:"Bananas"}]
    }
  ]},
  { id:'d3l', label:'Day 3 ‚Äî Trail Picnic', options:[
    { title:"üéí Rebel Rations Pack", sections:[
      {label:"PACK IN COOLER BAG",items:["Turkey + cheese roll-ups","String cheese","Trail mix","Granola bars","Fruit pouches for Sybastian","Water bottles (freeze overnight)"]}],
      grocery:[{c:"üçó Protein",i:"Turkey deli meat ‚Äî 8 oz"},{c:"üßÄ Dairy",i:"String cheese"},{c:"üçØ Pantry",i:"Trail mix"},{c:"üçØ Pantry",i:"Granola bars"},{c:"üçØ Pantry",i:"Fruit pouches"}]
    }
  ]},
  { id:'d3d', label:'Day 3 ‚Äî Dinner ‚Äî THE BIG ONE', options:[
    { title:"ü•© Jedi Council Feast", sections:[
      {label:"STEAK",items:["2 ribeye or NY strip steaks (1‚Äì1.5 lbs)","Salt / pepper / garlic powder","Butter + fresh rosemary"]},
      {label:"DIRECTIONS",items:["Bring steaks to room temp 30 min","Season generously","Grill 4‚Äì5 min per side for medium","Rest 5 min, top with butter + rosemary","Slice thin for Sybastian"],ordered:true},
      {label:"VEGGIES",items:["Asparagus or green beans + cherry tomatoes in foil","Drizzle olive oil, salt & pepper","Cook 15‚Äì20 min on fire"]},
      {label:"GARLIC BREAD",items:["Baguette or frozen garlic bread ‚Äî warm in foil"]},
      {label:"‚öîÔ∏è LIGHTSABER PRETZELS",items:["Pretzel rods dipped in green/blue candy melts (prep at home)"]},
      {label:"ü•Ç TOAST",items:["Sparkling apple cider ‚Äî saved for the Knighting!"]}],
      grocery:[{c:"üçó Protein",i:"2 steaks (ribeye or NY strip)"},{c:"ü•¶ Produce",i:"Asparagus or green beans"},{c:"ü•¶ Produce",i:"Cherry tomatoes ‚Äî 1 pint"},{c:"ü•¶ Produce",i:"Fresh rosemary (optional)"},{c:"üßÄ Dairy",i:"Butter ‚Äî 1 stick"},{c:"üçû Bread",i:"Baguette or frozen garlic bread"},{c:"üßÇ Spices",i:"Olive oil"},{c:"üßÇ Spices",i:"Garlic powder"},{c:"üßÇ Spices",i:"Salt + pepper"},{c:"ü•§ Beverages",i:"Sparkling apple cider"}]
    },
    { title:"üçó Mandalorian Grilled Chicken", sections:[
      {label:"INGREDIENTS",items:["2 lbs chicken thighs (bone-in for flavor)","2 lemons, juiced","Fresh rosemary + oregano","Garlic, minced","Olive oil, salt & pepper"]},
      {label:"DIRECTIONS",items:["Marinate chicken in lemon, herbs, garlic, oil for 30 min","Grill 7‚Äì8 min per side until cooked through","Rest 5 min, slice for serving","Slice thin for Sybastian"],ordered:true},
      {label:"VEGGIES",items:["Asparagus or green beans + cherry tomatoes in foil","Drizzle olive oil, salt & pepper","Cook 15‚Äì20 min on fire"]},
      {label:"GARLIC BREAD",items:["Baguette or frozen garlic bread ‚Äî warm in foil"]},
      {label:"ü•Ç TOAST",items:["Sparkling apple cider ‚Äî saved for the Knighting!"]}],
      grocery:[{c:"üçó Protein",i:"Chicken thighs ‚Äî 2 lbs"},{c:"ü•¶ Produce",i:"2 lemons"},{c:"ü•¶ Produce",i:"Fresh rosemary"},{c:"ü•¶ Produce",i:"1 garlic head"},{c:"ü•¶ Produce",i:"Asparagus or green beans"},{c:"ü•¶ Produce",i:"Cherry tomatoes ‚Äî 1 pint"},{c:"üçû Bread",i:"Baguette or frozen garlic bread"},{c:"üßÇ Spices",i:"Olive oil"},{c:"üßÇ Spices",i:"Oregano"},{c:"üßÇ Spices",i:"Salt + pepper"},{c:"ü•§ Beverages",i:"Sparkling apple cider"}]
    }
  ]},
  { id:'d4b', label:'Day 4 ‚Äî Brunch', options:[
    { title:"ü•û Galactic Send-off", sections:[
      {label:"INGREDIENTS",items:["Pancake mix + eggs + milk + butter","Bacon","Maple syrup","Fruit for Sybastian","Coffee"]},
      {label:"DIRECTIONS",items:["Mix batter per package","Use Star Wars cookie cutters for shapes (optional)","Cook bacon separately","Serve with syrup + fruit"],ordered:true}],
      grocery:[{c:"üçó Protein",i:"Bacon ‚Äî 1 pkg"},{c:"üçó Protein",i:"Eggs ‚Äî 1 dozen"},{c:"üßÄ Dairy",i:"Milk ‚Äî half gallon"},{c:"üßÄ Dairy",i:"Butter ‚Äî 1 stick"},{c:"üçû Bread",i:"Pancake mix"},{c:"üßÇ Spices",i:"Maple syrup"},{c:"ü•§ Beverages",i:"Coffee"}]
    },
    { title:"üåØ Hyperspace Breakfast Burritos", sections:[
      {label:"INGREDIENTS",items:["6 eggs","6 flour tortillas","Bacon or sausage","Shredded cheese","1 bell pepper, diced","Salsa"]},
      {label:"DIRECTIONS",items:["Cook bacon/sausage, chop into bits","Saut√© diced bell pepper 3 min","Scramble eggs, mix in meat and pepper","Spoon onto tortillas, top with cheese and salsa","Roll up and serve"],ordered:true}],
      grocery:[{c:"üçó Protein",i:"Eggs ‚Äî 1 dozen"},{c:"üçó Protein",i:"Bacon ‚Äî 1 pkg"},{c:"üßÄ Dairy",i:"Shredded cheese"},{c:"üçû Bread",i:"Flour tortillas ‚Äî 6-pack"},{c:"ü•¶ Produce",i:"1 bell pepper"},{c:"üçØ Pantry",i:"Salsa"},{c:"ü•§ Beverages",i:"Coffee"}]
    }
  ]}
];

const BASE_GROCERY = [
  {c:"üßÇ Spices",i:"Salt + pepper"},
  {c:"üßÇ Spices",i:"Olive oil"},
  {c:"ü•§ Beverages",i:"Water bottles ‚Äî case"}
];

const WARDROBE = [
  { day:"Day 1 ‚Äî Travel + Arrival", weather:"Arrive afternoon ~55‚Äì60¬∞F ¬∑ Evening drops to ~38¬∞F", people:[
    {name:"üó° MASTER MATTHANE SOL",lines:["Travel: Jeans, casual tee, sneakers, hoodie for the plane","Evening: Jedi robes over thermal base layer + warm pants, boots. Add beanie after dark."]},
    {name:"üåü YOUNGLING SYBA TAAN",lines:["Travel: Comfy play clothes, sneakers, zip-up jacket","Evening: Padawan costume over long-sleeve thermal + warm pants. Warm hat + gloves for stargazing."]},
    {name:"‚öîÔ∏è COMMANDER MEG'ARA KYN",lines:["Travel: Desert-tone comfy outfit (cream or slate), comfy shoes","Evening: Warm layers ‚Äî scarf, earth-tone wrap or jacket. Camera-ready but cozy."]}
  ]},
  { day:"Day 2 ‚Äî Full Training Day", weather:"Morning ~40¬∞F ¬∑ Afternoon ~58¬∞F ¬∑ Evening ~40¬∞F", people:[
    {name:"üó° MASTER MATTHANE SOL",lines:["Morning: Full Jedi robes over thermal base + fleece mid-layer, boots","Afternoon: Shed outer robe ‚Äî earth-tone henley, cargo pants, boots","Evening: Layer back up for campfire + movie night"]},
    {name:"üåü YOUNGLING SYBA TAAN",lines:["Morning: Padawan costume over thermals, warm closed-toe shoes","Afternoon: Comfy play clothes for pottery + trampoline (can get messy!)","Evening: Warm PJs + blanket for movie night"]},
    {name:"‚öîÔ∏è COMMANDER MEG'ARA KYN",lines:["Morning: Warrior costume with warm layers underneath, boots ‚Äî training photo ops!","Afternoon: Desert casual (earth-tone top + leggings, comfortable shoes)","Evening: Cozy layers, scarf, warm drink by the fire"]}
  ]},
  { day:"Day 3 ‚Äî Hike + Knighting Ceremony", weather:"Morning ~42¬∞F ¬∑ Afternoon ~60¬∞F ¬∑ Evening ~38¬∞F", people:[
    {name:"üó° MASTER MATTHANE SOL",lines:["Morning hike: Moisture-wicking base, fleece, hiking pants, hiking shoes, hat, sunglasses","Afternoon: Casual rest clothes","Evening ceremony: Full Jedi robes over warm base layers ‚Äî THIS is THE moment"]},
    {name:"üåü YOUNGLING SYBA TAAN",lines:["Morning hike: Warm layers, sturdy shoes, hat, sunscreen","Afternoon: Rest clothes / PJs for nap","Evening ceremony: Full Padawan robes over warm thermals ‚Äî HIS big moment"]},
    {name:"‚öîÔ∏è COMMANDER MEG'ARA KYN",lines:["Morning hike: Earth-tone hiking layers, sturdy shoes, hat, sunscreen","Afternoon: Comfortable rest wear","Evening ceremony: Warrior costume or desert elegant ‚Äî the ceremony photos!"]}
  ]},
  { day:"Day 4 ‚Äî Departure", weather:"Morning ~40¬∞F", people:[
    {name:"ALL",lines:["Comfortable travel clothes for the drive + flight home","üì∏ One last costume photo before packing up ‚Äî do this first thing!"]}
  ]}
];

const PACKING = [
  "Star Wars costume","Thermal base layers (3‚Äì4)","Warm fleece/jacket","Hiking shoes + casual shoes","Hat + sunglasses","Sunscreen","Beanie + gloves (evenings)","Warm scarf","Pajamas (2 sets)","Swimsuit (hot tub!)","Portable phone charger","Camera + extra battery","Reusable water bottles","Small first aid kit","Lightsabers (both!)","Small backpack (for hike)"
];

const PREP_BUY = [
  "7 Padawan Beads ‚Äî small wooden or colored beads, string on cord as earned",
  "1 Kyber Crystal ‚Äî real crystal, geode, or polished stone. Wrap in cloth",
  "3 Clue Cards ‚Äî handwrite or print on tea-stained paper. Age with crumpled edges",
  "Jedi Knight Certificate ‚Äî fancy certificate for Syba Taan",
  "Bandana ‚Äî for blindfold in Mission 1 (earth tone)",
  "Lightsaber Pretzels ‚Äî pretzel rods + green/blue candy melts. Dip at home",
  "Blue Food Coloring ‚Äî for Blue Milk",
  "Star Wars Cookie Cutters ‚Äî optional, Day 4 pancakes",
  "Small Notepad ‚Äî for mission log",
  "Rope or long stick ‚Äî for balance trial"
];

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   PACKING STATE (persisted)
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function loadPack() { try { return JSON.parse(localStorage.getItem('holo_pack')) || {}; } catch { return {}; } }
function savePack(s) { localStorage.setItem('holo_pack', JSON.stringify(s)); }
let packState = loadPack();
function togglePack(item, cb) { packState[item] = cb.checked; savePack(packState); }

function loadMeals() { try { return JSON.parse(localStorage.getItem('holo_meals')) || {}; } catch { return {}; } }
function saveMeals(s) { localStorage.setItem('holo_meals', JSON.stringify(s)); }
let mealState = loadMeals();
function getSlotChoice(slotId) { return mealState[slotId] || 0; }
function setSlotChoice(slotId, idx) {
  mealState[slotId] = idx; saveMeals(mealState);
  const card = document.querySelector(`[data-slot="${slotId}"]`);
  const wasOpen = card && card.classList.contains('open');
  const slot = MEAL_SLOTS.find(s => s.id === slotId);
  const r = slot.options[idx];
  const next = (idx + 1) % slot.options.length;
  card.querySelector('.rc-title').textContent = r.title;
  card.querySelector('.swap-toggle').setAttribute('onclick', `event.stopPropagation();setSlotChoice('${slotId}',${next})`);
  card.querySelector('.rc-content').innerHTML = r.sections.map(s => `
    <div class="rc-label">${s.label}</div>
    ${s.ordered ? `<ol>${s.items.map(i => `<li>${i}</li>`).join('')}</ol>` : `<ul>${s.items.map(i => `<li>${i}</li>`).join('')}</ul>`}
  `).join('');
  if (wasOpen) card.classList.add('open');
  rebuildGrocery();
}

function loadGroceryChecks() { try { return JSON.parse(localStorage.getItem('holo_groc')) || {}; } catch { return {}; } }
function saveGroceryChecks(s) { localStorage.setItem('holo_groc', JSON.stringify(s)); }
let groceryChecks = loadGroceryChecks();
function toggleGrocery(item, cb) {
  groceryChecks[item] = cb.checked;
  saveGroceryChecks(groceryChecks);
  cb.parentElement.classList.toggle('checked', cb.checked);
}

/* Custom packing items */
function loadCustomPack() { try { return JSON.parse(localStorage.getItem('holo_custom_pack')) || []; } catch { return []; } }
function saveCustomPack(a) { localStorage.setItem('holo_custom_pack', JSON.stringify(a)); }
let customPack = loadCustomPack();
function addPackItem(input) { const v = input.value.trim(); if (!v) return; customPack.push(v); saveCustomPack(customPack); input.value = ''; renderWardrobe(); }
function removePackItem(idx) { customPack.splice(idx, 1); saveCustomPack(customPack); renderWardrobe(); }

/* Custom grocery items */
function loadCustomGroc() { try { return JSON.parse(localStorage.getItem('holo_custom_groc')) || []; } catch { return []; } }
function saveCustomGroc(a) { localStorage.setItem('holo_custom_groc', JSON.stringify(a)); }
let customGroc = loadCustomGroc();
function addGrocItem(cat, input) { const v = input.value.trim(); if (!v) return; customGroc.push({c:cat, i:v}); saveCustomGroc(customGroc); input.value = ''; rebuildGrocery(); }
function removeGrocItem(idx) { customGroc.splice(idx, 1); saveCustomGroc(customGroc); rebuildGrocery(); }

function buildGroceryList() {
  const all = [...BASE_GROCERY];
  MEAL_SLOTS.forEach(slot => {
    const choice = getSlotChoice(slot.id);
    const recipe = slot.options[choice];
    if (recipe && recipe.grocery) all.push(...recipe.grocery);
  });
  const cats = {};
  const catOrder = ["üçó Protein","ü•¶ Produce","üßÄ Dairy","üçû Bread","üçØ Pantry","üßÇ Spices","ü•§ Beverages"];
  catOrder.forEach(c => cats[c] = []);
  all.forEach(g => {
    if (!cats[g.c]) cats[g.c] = [];
    if (!cats[g.c].includes(g.i)) cats[g.c].push(g.i);
  });
  return catOrder.filter(c => cats[c].length > 0).map(c => ({cat:c, items:cats[c]}));
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   NAVIGATION
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const TAB_ORDER = ['hub','itinerary','missions','meals','wardrobe','gallery'];
function showTab(name) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.getElementById(name + 'Screen').classList.add('active');
  document.querySelectorAll('.tab')[TAB_ORDER.indexOf(name)].classList.add('active');
  window.scrollTo(0, 0);
}

function goTab(name) { showTab(name); }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   TOGGLE ACCORDION
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function toggle(el) { el.closest('.day-card,.ms-card,.recipe-card,.cloth-card').classList.toggle('open'); }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RENDER HUB
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderHub() {
  document.getElementById('hubScreen').innerHTML = `
    <div class="countdown" id="countdown"></div>
    <div class="hub-grid">
      <div class="hub-card" onclick="goTab('itinerary')">
        <div class="hc-icon">üìã</div>
        <div class="hc-title">ITINERARY</div>
        <div class="hc-desc">4-day timeline with missions, meals & photo ops</div>
      </div>
      <div class="hub-card" onclick="goTab('missions')">
        <div class="hc-icon">‚öîÔ∏è</div>
        <div class="hc-title">MISSIONS</div>
        <div class="hc-desc">8 Jedi training missions with dialogue & props</div>
      </div>
      <div class="hub-card" onclick="goTab('meals')">
        <div class="hc-icon">üçΩÔ∏è</div>
        <div class="hc-title">PROVISIONS</div>
        <div class="hc-desc">Themed recipes & master grocery list</div>
      </div>
      <div class="hub-card" onclick="goTab('wardrobe')">
        <div class="hc-icon">üëï</div>
        <div class="hc-title">WARDROBE</div>
        <div class="hc-desc">Day-by-day clothing guide & packing checklist</div>
      </div>
    </div>
    <a href="../printables/index.html" target="_blank" class="transmission-link">üñ®Ô∏è PRINTABLES ‚Äî Clue Cards ¬∑ Certificate ¬∑ Chant ¬∑ Activity Book</a>
    <a href="https://megan-fairchild.github.io/outpost-x-mission/" target="_blank" class="transmission-link">üì° VIEW ORIGINAL TRANSMISSION</a>
    <div style="text-align:center;margin-top:12px">
      <a href="https://megan-fairchild.github.io/outpost-x-mission/app/" target="_blank" class="ext-link">üó°Ô∏è Missions Tracker App</a>
    </div>
    <div style="text-align:center;margin-top:20px">
      <a href="https://outpost-x.com/" target="_blank" class="ext-link">üåê OutpostX</a>
      <a href="https://stateparks.utah.gov/parks/snow-canyon/" target="_blank" class="ext-link">üèúÔ∏è Snow Canyon</a>
      <a href="https://www.alltrails.com/trail/us/utah/petrified-sand-dune-trail" target="_blank" class="ext-link">ü™® Petrified Dunes</a>
      <a href="https://www.alltrails.com/trail/us/utah/lava-tubes-via-lava-flow-trail" target="_blank" class="ext-link">üåã Lava Flow</a>
    </div>
    <div class="family-badge">
      <div class="names">Master Matthane Sol ¬∑ Youngling Syba Taan ¬∑ Commander Meg'ara Kyn</div>
      <div style="margin-top:4px">April 8‚Äì11, 2026 ¬∑ OutpostX Beryl Utah ¬∑ Glass Cave Villa</div>
      <div style="margin-top:12px;color:var(--gold);font-family:'Orbitron',sans-serif;font-size:11px;letter-spacing:2px">MAY THE FORCE BE WITH YOU. ALWAYS.</div>
    </div>`;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RENDER ITINERARY
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderItinerary() {
  document.getElementById('itineraryScreen').innerHTML = DAYS.map(d => `
    <div class="day-card">
      <div class="day-head" onclick="toggle(this)">
        <div class="day-badge">${d.num}</div>
        <div class="day-info">
          <div class="day-name">"${d.name}"</div>
          <div class="day-date">${d.date}</div>
        </div>
        <span class="day-chev">‚ñæ</span>
      </div>
      <div class="day-body"><div class="day-content">
        <ul class="tl">${d.items.map(i => `<li><span class="time">${i.t}</span><span>${i.e}</span></li>`).join('')}</ul>
        <div class="photo-ops"><b>üì∏ PHOTO OPS</b><ul>${d.photos.map(p => `<li>${p}</li>`).join('')}</ul></div>
      </div></div>
    </div>`).join('');
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RENDER MISSIONS
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderMissions() {
  const el = document.getElementById('missionsScreen');
  el.innerHTML = MISSIONS.map(m => `
    <div class="ms-card">
      <div class="ms-head" onclick="toggle(this)">
        <div class="ms-num">${m.id}</div>
        <div class="ms-info">
          <div class="ms-title">${m.title}</div>
          <div class="ms-meta">${m.meta}</div>
        </div>
        <span class="ms-chev">‚ñæ</span>
      </div>
      <div class="ms-body"><div class="ms-content">
        <div class="ms-label">MASTER SAYS</div>
        <p class="ms-narrative">"${m.dialogue}"</p>
        <div class="ms-label">ACTIVITY</div>
        <p>${m.activity}</p>
        <div class="ms-label">PROPS</div>
        <ul>${m.props.map(p => `<li>${p}</li>`).join('')}</ul>
        ${m.note ? `<div class="ms-note">${m.note}</div>` : ''}
        <div class="ms-label">REWARD</div>
        <p><span class="ms-reward">‚≠ê ${m.reward}</span></p>
        ${m.id === 6 ? '<div style="margin-top:10px"><a href="../printables/clue-cards.html" target="_blank" class="mission-artifact">üìú PRINT CLUE CARDS</a></div>' : ''}
        ${m.id === 8 ? '<div style="margin-top:10px"><a href="../printables/certificate.html" target="_blank" class="mission-artifact">üåü PRINT CERTIFICATE</a></div>' : ''}
      </div></div>
    </div>`).join('') + `

    <div class="section-title">MISSION PREP KIT</div>
    <div class="prep-box">
      <h4>BUY / MAKE BEFORE DEPARTURE</h4>
      <ul style="list-style:none;padding:0">${PREP_BUY.map(p => `<li style="font-size:13px;color:#bbb;padding:4px 0;line-height:1.6">‚ñ∏ ${p}</li>`).join('')}</ul>
    </div>
    <div class="prep-box code">
      <h4 style="color:var(--gold)">TEACH SYBASTIAN BEFORE THE TRIP</h4>
      <p style="font-size:12px;color:#bbb;margin-bottom:8px">The Youngling Jedi Code ‚Äî practice at home for the Final Trials:</p>
      <div class="code-text">"I am calm.<br>I am kind.<br>I am brave.<br>I am one with the Force."</div>
      <div style="margin-top:10px"><a href="../printables/chant-card.html" target="_blank" class="mission-artifact">‚öîÔ∏è PRINT CHANT CARD</a></div>
    </div>
    <a href="../printables/index.html" target="_blank" class="transmission-link">üñ®Ô∏è PRINTABLES ‚Äî Clue Cards ¬∑ Certificate ¬∑ Chant ¬∑ Activity Book</a>
    <a href="../app/index.html" target="_blank" style="display:block;text-align:center;margin:20px 0;padding:14px;background:var(--orange);color:#000;border-radius:var(--r);font-family:'Orbitron',sans-serif;font-weight:700;font-size:14px;letter-spacing:1px;text-decoration:none">üéØ LAUNCH MISSION TRACKER APP</a>`;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RENDER MEALS
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderMeals() {
  const el = document.getElementById('mealsScreen');
  const recipes = MEAL_SLOTS.map(slot => {
    const sel = getSlotChoice(slot.id);
    const r = slot.options[sel];
    const hasAlts = slot.options.length > 1;
    return `
    <div class="recipe-card" data-slot="${slot.id}">
      ${hasAlts ? `<button class="swap-toggle" onclick="event.stopPropagation();setSlotChoice('${slot.id}',${(sel+1)%slot.options.length})">‚áÑ SWAP</button>` : ''}
      <div class="rc-head" onclick="toggle(this)">
        <div>
          <div class="rc-title">${r.title}</div>
          <div class="rc-when">${slot.label}</div>
        </div>
        <span class="rc-chev">‚ñæ</span>
      </div>
      <div class="rc-body"><div class="rc-content">
        ${r.sections.map(s => `
          <div class="rc-label">${s.label}</div>
          ${s.ordered ? `<ol>${s.items.map(i => `<li>${i}</li>`).join('')}</ol>` : `<ul>${s.items.map(i => `<li>${i}</li>`).join('')}</ul>`}
        `).join('')}
      </div></div>
    </div>`;
  }).join('');

  const groceryHtml = buildGroceryHtml();

  el.innerHTML = recipes + `<div id="groceryContainer">${groceryHtml}</div>`;
}

function buildGroceryHtml() {
  const groceryList = buildGroceryList();
  const customByCat = {};
  customGroc.forEach((g, idx) => { if (!customByCat[g.c]) customByCat[g.c] = []; customByCat[g.c].push({i:g.i, idx}); });

  let html = `<div class="section-title">MASTER GROCERY LIST</div>
    <p style="font-size:12px;color:var(--dim);margin-bottom:8px">Auto-updated based on selected meals ‚Ä¢ Buy in Las Vegas or St. George</p>
    <div style="text-align:right;margin-bottom:12px"><button class="export-btn" onclick="exportGrocery()">üìã COPY LIST</button></div>`;

  groceryList.forEach(g => {
    const customs = customByCat[g.cat] || [];
    delete customByCat[g.cat];
    html += `<div class="grocery-section"><h4>${g.cat}</h4><ul>`;
    html += g.items.map(i => {
      const ck = groceryChecks[i] ? 'checked' : '';
      return `<li><label class="grocery-check ${ck?'checked':''}"><input type="checkbox" ${ck} onchange="toggleGrocery('${i.replace(/'/g,"\\'")}',this)">${i}</label></li>`;
    }).join('');
    html += customs.map(c => {
      const ck = groceryChecks[c.i] ? 'checked' : '';
      return `<li style="display:flex;align-items:center"><label class="grocery-check ${ck?'checked':''}" style="flex:1"><input type="checkbox" ${ck} onchange="toggleGrocery('${c.i.replace(/'/g,"\\'")}',this)">${c.i}</label><button class="del-btn" onclick="removeGrocItem(${c.idx})">‚úï</button></li>`;
    }).join('');
    const esc = g.cat.replace(/'/g,"\\'");
    html += `</ul><div class="add-item-row"><input class="add-item-input" placeholder="Add item‚Ä¶" onkeydown="if(event.key==='Enter')addGrocItem('${esc}',this)"><button class="add-btn" onclick="addGrocItem('${esc}',this.previousElementSibling)">+ ADD</button></div></div>`;
  });

  Object.keys(customByCat).forEach(cat => {
    const customs = customByCat[cat];
    html += `<div class="grocery-section"><h4>${cat}</h4><ul>`;
    html += customs.map(c => {
      const ck = groceryChecks[c.i] ? 'checked' : '';
      return `<li style="display:flex;align-items:center"><label class="grocery-check ${ck?'checked':''}" style="flex:1"><input type="checkbox" ${ck} onchange="toggleGrocery('${c.i.replace(/'/g,"\\'")}',this)">${c.i}</label><button class="del-btn" onclick="removeGrocItem(${c.idx})">‚úï</button></li>`;
    }).join('');
    const esc = cat.replace(/'/g,"\\'");
    html += `</ul><div class="add-item-row"><input class="add-item-input" placeholder="Add item‚Ä¶" onkeydown="if(event.key==='Enter')addGrocItem('${esc}',this)"><button class="add-btn" onclick="addGrocItem('${esc}',this.previousElementSibling)">+ ADD</button></div></div>`;
  });

  return html;
}

function rebuildGrocery() {
  const gc = document.getElementById('groceryContainer');
  if (gc) gc.innerHTML = buildGroceryHtml();
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   RENDER WARDROBE
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderWardrobe() {
  const el = document.getElementById('wardrobeScreen');
  const cards = WARDROBE.map(w => `
    <div class="cloth-card">
      <div class="cl-head" onclick="toggle(this)">
        <div>
          <div class="cl-title">${w.day}</div>
          <div class="cl-weather">${w.weather}</div>
        </div>
        <span class="cl-chev">‚ñæ</span>
      </div>
      <div class="cl-body"><div class="cl-content">
        ${w.people.map(p => `<div class="person-block"><div class="person-name">${p.name}</div>${p.lines.map(l => `<p>${l}</p>`).join('')}</div>`).join('')}
      </div></div>
    </div>`).join('');

  const packing = `<div class="section-title">üß≥ PACKING CHECKLIST</div>
    <div style="text-align:right;margin-bottom:8px"><button class="export-btn" onclick="exportPacking()">üìã COPY LIST</button></div>
    <div style="background:var(--card);border-radius:var(--r);padding:14px 16px;margin-bottom:14px">
      <div class="pack-grid">
        ${PACKING.map(p => `<label><input type="checkbox" ${packState[p]?'checked':''} onchange="togglePack('${p.replace(/'/g,"\\'")}',this)">${p}</label>`).join('')}
        ${customPack.map((p,i) => `<label style="display:flex;align-items:center"><input type="checkbox" ${packState[p]?'checked':''} onchange="togglePack('${p.replace(/'/g,"\\'")}',this)"><span style="flex:1">${p}</span><button class="del-btn" onclick="event.preventDefault();removePackItem(${i})">‚úï</button></label>`).join('')}
      </div>
      <div class="add-item-row" style="margin-top:12px"><input class="add-item-input" placeholder="Add packing item‚Ä¶" onkeydown="if(event.key==='Enter')addPackItem(this)"><button class="add-btn" onclick="addPackItem(this.previousElementSibling)">+ ADD</button></div>
    </div>`;

  el.innerHTML = cards + packing;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   COUNTDOWN TIMER
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const EVENT_START = new Date('2026-04-08T14:30:00-06:00');
const EVENT_END = new Date('2026-04-11T10:00:00-06:00');
function updateCountdown() {
  const el = document.getElementById('countdown');
  if (!el) return;
  const now = new Date();
  if (now >= EVENT_END) {
    el.innerHTML = '<div class="cd-label">OPERATION OUTPOST X</div><div class="cd-status">‚≠ê MISSION COMPLETE ‚≠ê</div>';
    return;
  }
  if (now >= EVENT_START) {
    el.innerHTML = '<div class="cd-label">OPERATION OUTPOST X</div><div class="cd-status">üöÄ THE MISSION HAS BEGUN üöÄ</div>';
    return;
  }
  const diff = EVENT_START - now;
  const d = Math.floor(diff / 86400000);
  const h = Math.floor((diff % 86400000) / 3600000);
  const m = Math.floor((diff % 3600000) / 60000);
  const s = Math.floor((diff % 60000) / 1000);
  el.innerHTML = `<div class="cd-label">MISSION LAUNCH IN</div>
    <div class="cd-grid">
      <div class="cd-unit"><div class="cd-num">${d}</div><div class="cd-lbl">DAYS</div></div>
      <div class="cd-unit"><div class="cd-num">${String(h).padStart(2,'0')}</div><div class="cd-lbl">HRS</div></div>
      <div class="cd-unit"><div class="cd-num">${String(m).padStart(2,'0')}</div><div class="cd-lbl">MIN</div></div>
      <div class="cd-unit"><div class="cd-num">${String(s).padStart(2,'0')}</div><div class="cd-lbl">SEC</div></div>
    </div>`;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   THEME TOGGLE
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function loadTheme() { return localStorage.getItem('holo_theme') || 'dark'; }
function applyTheme(t) {
  document.documentElement.classList.toggle('light', t === 'light');
  const btn = document.getElementById('themeBtn');
  if (btn) btn.textContent = t === 'light' ? 'üåô' : '‚òÄÔ∏è';
  localStorage.setItem('holo_theme', t);
}
function toggleTheme() { applyTheme(loadTheme() === 'dark' ? 'light' : 'dark'); }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   SHARE / EXPORT
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function showToast(msg) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), 2000);
}
function shareApp() {
  const url = window.location.href;
  if (navigator.share) {
    navigator.share({title:'Holocron Archives',text:'üìú Operation OutpostX ‚Äî Full Mission Briefing',url}).catch(()=>{});
  } else {
    navigator.clipboard.writeText(url).then(() => showToast('LINK COPIED'));
  }
}
function exportGrocery() {
  const list = buildGroceryList();
  const customByCat = {};
  customGroc.forEach(g => { if (!customByCat[g.c]) customByCat[g.c] = []; customByCat[g.c].push(g.i); });
  let text = 'üõí OUTPOST X ‚Äî GROCERY LIST\n\n';
  list.forEach(g => {
    text += g.cat + '\n';
    g.items.forEach(i => text += '  ‚ñ° ' + i + '\n');
    (customByCat[g.cat] || []).forEach(i => text += '  ‚ñ° ' + i + '\n');
    text += '\n';
  });
  navigator.clipboard.writeText(text).then(() => showToast('GROCERY LIST COPIED'));
}
function exportPacking() {
  let text = 'üß≥ OUTPOST X ‚Äî PACKING LIST\n\n';
  [...PACKING, ...customPack].forEach(p => text += '‚ñ° ' + p + '\n');
  navigator.clipboard.writeText(text).then(() => showToast('PACKING LIST COPIED'));
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   PHOTO GALLERY
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function loadPhotos() { try { return JSON.parse(localStorage.getItem('holo_photos')) || []; } catch { return []; } }
function savePhotos(p) { localStorage.setItem('holo_photos', JSON.stringify(p)); }
let photos = loadPhotos();
let lbIndex = 0;

function compressImage(file) {
  return new Promise(resolve => {
    const reader = new FileReader();
    reader.onload = e => {
      const img = new Image();
      img.onload = () => {
        const canvas = document.createElement('canvas');
        const MAX = 800;
        let w = img.width, h = img.height;
        if (w > MAX) { h = h * MAX / w; w = MAX; }
        if (h > MAX) { w = w * MAX / h; h = MAX; }
        canvas.width = w; canvas.height = h;
        canvas.getContext('2d').drawImage(img, 0, 0, w, h);
        resolve(canvas.toDataURL('image/jpeg', 0.7));
      };
      img.src = e.target.result;
    };
    reader.readAsDataURL(file);
  });
}

async function handlePhotos(files) {
  if (photos.length >= 50) { showToast('MAX 50 PHOTOS'); return; }
  for (const file of files) {
    if (photos.length >= 50) break;
    const data = await compressImage(file);
    photos.push({src:data, cap:'', ts:Date.now()});
  }
  savePhotos(photos);
  renderGallery();
  document.getElementById('photoInput').value = '';
}

function deletePhoto(idx) { photos.splice(idx, 1); savePhotos(photos); renderGallery(); }

function editCaption(idx) {
  const cap = prompt('Caption:', photos[idx].cap || '');
  if (cap !== null) { photos[idx].cap = cap; savePhotos(photos); renderGallery(); }
}

function openLightbox(idx) {
  lbIndex = idx;
  document.getElementById('lbImg').src = photos[idx].src;
  document.getElementById('lbCap').textContent = photos[idx].cap || 'Tap to add caption';
  document.getElementById('lightbox').classList.add('active');
}

function closeLightbox(e) {
  if (e && e.target !== e.currentTarget && !e.target.classList.contains('lb-close')) return;
  document.getElementById('lightbox').classList.remove('active');
}

function navLightbox(dir) {
  lbIndex = (lbIndex + dir + photos.length) % photos.length;
  document.getElementById('lbImg').src = photos[lbIndex].src;
  document.getElementById('lbCap').textContent = photos[lbIndex].cap || 'Tap to add caption';
}

function renderGallery() {
  const el = document.getElementById('galleryScreen');
  if (!photos.length) {
    el.innerHTML = `<div class="section-title">üì∏ MISSION MEMORIES</div>
      <div class="gallery-empty"><div class="ge-icon">üì∏</div><p>No memories yet.<br>Add photos from your mission!</p></div>
      <button class="add-photo-btn" onclick="document.getElementById('photoInput').click()">üì∑ ADD MEMORIES</button>`;
    return;
  }
  el.innerHTML = `<div class="section-title">üì∏ MISSION MEMORIES</div>
    <button class="add-photo-btn" onclick="document.getElementById('photoInput').click()" style="margin-bottom:16px">üì∑ ADD MEMORIES</button>
    <div class="gallery-grid">${photos.map((p,i) => `
      <div class="gallery-thumb" onclick="openLightbox(${i})">
        <img src="${p.src}" alt="Memory ${i+1}" loading="lazy">
        <button class="gt-del" onclick="event.stopPropagation();deletePhoto(${i})">‚úï</button>
        ${p.cap ? `<div class="gt-cap">${p.cap}</div>` : ''}
      </div>`).join('')}
    </div>
    <p style="text-align:center;font-size:11px;color:var(--dim);margin-top:8px">${photos.length}/50 memories ‚Ä¢ Tap photo for fullscreen</p>`;
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   INIT
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
applyTheme(loadTheme());
renderHub();
renderItinerary();
renderMissions();
renderMeals();
renderWardrobe();
renderGallery();
updateCountdown();
setInterval(updateCountdown, 1000);

document.addEventListener('keydown', e => {
  if (!document.getElementById('lightbox').classList.contains('active')) return;
  if (e.key === 'Escape') closeLightbox();
  if (e.key === 'ArrowLeft') navLightbox(-1);
  if (e.key === 'ArrowRight') navLightbox(1);
});

if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js').catch(() => {});
}
</script>
</body>
</html>
